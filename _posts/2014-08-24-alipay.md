---
title: 接入支付宝的心得
layout: post
guid: QHxniDtXv7jQ
date: 2014-08-24 20:23:00
tags:
   - 
---

前两周一直在处理支付宝付款的事情，总结一下支付宝的使用心得。

## Gem

黄增光写的 [alipay](https://github.com/chloerei/alipay) 是目前遇到的最好的 Gem，使用也超级方便。

代码优美，菜鸟拿来即用。


## 支付宝的接口类型


1. 担保交易（屌丝开发者首选）

    屌丝开发者通过实名认证之后就能使用。


2. 即时到账（web）

    只有企业支付宝帐号才能申请。客户付款后直接划到你的帐下。


3. 即时到账（wap）

    相对于 web 版的即时到账，只不过支持响应式而已，在手机上体验好了一点。除此之外，没啥大的区别。

    不知道支付宝的同学为什么把即时到帐拆成两个接口。


4. 标准双接口

    支付宝标准接口包含支付宝担保交易和即时到账接口两种接口模式，让客户自主选择交易模式。

    Don't make me think. 标准双接口让用户困惑，让开发者困惑。我实在理解不了支付宝的这个接口的用意。


## 支付宝的回调方式？

1. callback url（给用户看的）

    用户付款成功之后，直接跳转回商户指定的 url。

2. notify url（用于通知商家的后端）

    用户付款成功后，支付宝的服务器直接请求商户的后台。


## 付款成功后，支付宝会告诉我们哪些参数呢？

大部分是交易的具体参数，除此之外我们还能拿到用户注册支付宝的手机（或邮箱）。

这一点比较赞，可以收集到商户的数据库中。


![支付宝]({{ site.url }}/media/files/2014/Aug/24-alipay.png)

